
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>day14 | Hexo</title>
        <meta name="author" content="John Doe" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
        <link rel="icon" href="/myblog.github.io/null" />
        <script src="https://cdn.staticfile.org/vue/3.2.47/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.3.0/css/all.min.css" />
<link rel="stylesheet" href="/myblog.github.io/css/fonts.min.css" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


<script src="https://cdn.staticfile.org/highlight.js/11.7.0/highlight.min.js"></script>
<link
    rel="stylesheet"
    href="https://cdn.staticfile.org/highlight.js/11.7.0/styles/github.min.css"
/>
<script src="/myblog.github.io/js/lib/highlight.js"></script>



<script src="/myblog.github.io/js/lib/preview.js"></script>









<link rel="stylesheet" href="/myblog.github.io/css/main.css" />

    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <div id="layout">
            <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/myblog.github.io/images/loading.gif" />
                </div>
            </div>
            </transition>
            <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/myblog.github.io/">
            <span>HEXO</span>
        </a>
        
        <a href="/myblog.github.io/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/myblog.github.io/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/myblog.github.io/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/myblog.github.io/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/myblog.github.io/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;HEXO</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/myblog.github.io/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/myblog.github.io/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/myblog.github.io/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/myblog.github.io/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/myblog.github.io/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>day14</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2022/12/22
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            <span class="tag">
                
                <a href="/myblog.github.io/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="color: #00a596">面试题</a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <p>后端获取数据向前端输出的过程中，输出前应该采用信息安全部发布的XSSFilter进行相应的编码。XSS过滤器是前端的一种过滤方式。</p>
<p>Java线程</p>
<p>私有：虚拟机栈，程序计数器，本地方法站</p>
<p>共享：堆，方法区</p>
<p>运行时常量池</p>
<ul>
<li><p>常量池的大小受方法区大小的影响</p>
</li>
<li><p>存放了编译时期生成的各种字面量</p>
</li>
<li><p>存放编译时期生成的<strong>符号引用</strong></p>
</li>
</ul>
<p>符号引用是以一组符号来描述所引用的目标，可以为任何形式的字面量，只要使用时无歧义即可。在解析阶段会将会将符号引用转换成直接引用。</p>
<h2 id="浮点数的精度丢失问题："><a href="#浮点数的精度丢失问题：" class="headerlink" title="浮点数的精度丢失问题："></a>浮点数的精度丢失问题：</h2><p>计算机表示数字的宽度有限，无限循环的小鼠存在计算机中只能被截断，从而发生精度丢失的情况。</p>
<p>为了便面精度丢失我们可以用<code>BigDecimal</code>来进行浮点运算，</p>
<p>浮点数之间的判断不能用&#x3D;&#x3D;，包装类之间的判断不能哟个equals</p>
<h3 id="创建BigDecimal对象："><a href="#创建BigDecimal对象：" class="headerlink" title="创建BigDecimal对象："></a>创建BigDecimal对象：</h3><p>推荐使用它的<code>BigDecimal(String val)</code>构造方法或者 <code>BigDecimal.valueOf(double val)</code> 静态方法来创建对象。</p>
<p>在阿里巴巴Java开发手册中提到，禁止使用BigDecimal(double)吧double的值转换为BigDecimal对象</p>
<p>加减乘除</p>
<pre><code class="java">BigDecimal a = new BigDecimal(&quot;1.0&quot;);
BigDecimal b = new BigDecimal(&quot;0.9&quot;);
System.out.println(a.add(b));// 1.9
System.out.println(a.subtract(b));// 0.1
System.out.println(a.multiply(b));// 0.90
System.out.println(a.divide(b));// 无法除尽，抛出 ArithmeticException 异常
System.out.println(a.divide(b, 2, RoundingMode.HALF_UP));// 1.11
</code></pre>
<p>divide最好使用三个参数版本的并且<code>RoundingMode</code> 不要选择 <code>UNNECESSARY</code>，否则很可能会遇到 <code>ArithmeticException</code>（无法除尽出现无限循环小数的时候），其中<code>divisor</code>代表除数 <code>scale</code> 表示要保留几位小数，<code>roundingMode</code> 代表保留规则。</p>
<pre><code class="java">public BigDecimal divide(BigDecimal divisor, int scale, RoundingMode roundingMode) &#123;
    return divide(divisor, scale, roundingMode.oldMode);
&#125;
</code></pre>
<p>比较大小：</p>
<p>使用compareTo() </p>
<p>a.compareTo(b);结果为1表示a&gt;b,结果为0 表示a&#x3D;b,结果为-1表示a&lt;b</p>
<p>可以通过setScale()设置保留的小数位数</p>
<p><strong>注意BigDecimal对象建议使用compareTo比较，因为equals比较不光会比较大小，还会比较精度，而 compareTo会忽略精度</strong></p>
<h3 id="工具类"><a href="#工具类" class="headerlink" title="工具类"></a>工具类</h3><pre><code class="java">import java.math.BigDecimal;
import java.math.RoundingMode;

/**
 * 简化BigDecimal计算的小工具类
 */
public class BigDecimalUtil &#123;

    /**
     * 默认除法运算精度
     */
    private static final int DEF_DIV_SCALE = 10;

    private BigDecimalUtil() &#123;
    &#125;

    /**
     * 提供精确的加法运算。
     *
     * @param v1 被加数
     * @param v2 加数
     * @return 两个参数的和
     */
    public static double add(double v1, double v2) &#123;
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.add(b2).doubleValue();
    &#125;

    /**
     * 提供精确的减法运算。
     *
     * @param v1 被减数
     * @param v2 减数
     * @return 两个参数的差
     */
    public static double subtract(double v1, double v2) &#123;
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.subtract(b2).doubleValue();
    &#125;

    /**
     * 提供精确的乘法运算。
     *
     * @param v1 被乘数
     * @param v2 乘数
     * @return 两个参数的积
     */
    public static double multiply(double v1, double v2) &#123;
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.multiply(b2).doubleValue();
    &#125;

    /**
     * 提供（相对）精确的除法运算，当发生除不尽的情况时，精确到
     * 小数点以后10位，以后的数字四舍五入。
     *
     * @param v1 被除数
     * @param v2 除数
     * @return 两个参数的商
     */
    public static double divide(double v1, double v2) &#123;
        return divide(v1, v2, DEF_DIV_SCALE);
    &#125;

    /**
     * 提供（相对）精确的除法运算。当发生除不尽的情况时，由scale参数指
     * 定精度，以后的数字四舍五入。
     *
     * @param v1    被除数
     * @param v2    除数
     * @param scale 表示表示需要精确到小数点以后几位。
     * @return 两个参数的商
     */
    public static double divide(double v1, double v2, int scale) &#123;
        if (scale &lt; 0) &#123;
            throw new IllegalArgumentException(
                    &quot;The scale must be a positive integer or zero&quot;);
        &#125;
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.divide(b2, scale, RoundingMode.HALF_UP).doubleValue();
    &#125;

    /**
     * 提供精确的小数位四舍五入处理。
     *
     * @param v     需要四舍五入的数字
     * @param scale 小数点后保留几位
     * @return 四舍五入后的结果
     */
    public static double round(double v, int scale) &#123;
        if (scale &lt; 0) &#123;
            throw new IllegalArgumentException(
                    &quot;The scale must be a positive integer or zero&quot;);
        &#125;
        BigDecimal b = BigDecimal.valueOf(v);
        BigDecimal one = new BigDecimal(&quot;1&quot;);
        return b.divide(one, scale, RoundingMode.HALF_UP).doubleValue();
    &#125;

    /**
     * 提供精确的类型转换(Float)
     *
     * @param v 需要被转换的数字
     * @return 返回转换结果
     */
    public static float convertToFloat(double v) &#123;
        BigDecimal b = new BigDecimal(v);
        return b.floatValue();
    &#125;

    /**
     * 提供精确的类型转换(Int)不进行四舍五入
     *
     * @param v 需要被转换的数字
     * @return 返回转换结果
     */
    public static int convertsToInt(double v) &#123;
        BigDecimal b = new BigDecimal(v);
        return b.intValue();
    &#125;

    /**
     * 提供精确的类型转换(Long)
     *
     * @param v 需要被转换的数字
     * @return 返回转换结果
     */
    public static long convertsToLong(double v) &#123;
        BigDecimal b = new BigDecimal(v);
        return b.longValue();
    &#125;

    /**
     * 返回两个数中大的一个值
     *
     * @param v1 需要被对比的第一个数
     * @param v2 需要被对比的第二个数
     * @return 返回两个数中大的一个值
     */
    public static double returnMax(double v1, double v2) &#123;
        BigDecimal b1 = new BigDecimal(v1);
        BigDecimal b2 = new BigDecimal(v2);
        return b1.max(b2).doubleValue();
    &#125;

    /**
     * 返回两个数中小的一个值
     *
     * @param v1 需要被对比的第一个数
     * @param v2 需要被对比的第二个数
     * @return 返回两个数中小的一个值
     */
    public static double returnMin(double v1, double v2) &#123;
        BigDecimal b1 = new BigDecimal(v1);
        BigDecimal b2 = new BigDecimal(v2);
        return b1.min(b2).doubleValue();
    &#125;

    /**
     * 精确对比两个数字
     *
     * @param v1 需要被对比的第一个数
     * @param v2 需要被对比的第二个数
     * @return 如果两个数一样则返回0，如果第一个数比第二个数大则返回1，反之返回-1
     */
    public static int compareTo(double v1, double v2) &#123;
        BigDecimal b1 = BigDecimal.valueOf(v1);
        BigDecimal b2 = BigDecimal.valueOf(v2);
        return b1.compareTo(b2);
    &#125;

&#125;
</code></pre>
<h2 id="Java-IO的常见面试题"><a href="#Java-IO的常见面试题" class="headerlink" title="Java IO的常见面试题"></a>Java IO的常见面试题</h2><h3 id="什么是IO"><a href="#什么是IO" class="headerlink" title="什么是IO"></a>什么是IO</h3><p>即输入与输出</p>
<p>是计算机系统与外部设备通信的过程</p>
<p>为了保证系统的稳定与安全，一个进程的地址空间分为用户空间和内核空间</p>
<p>我们平常允许的应用程序都是在用户空间上运行，想要进行IO操作，需要借助内核空间的能力</p>
<p>用户进程通过<code>系统调用</code>访问内核空间进行IO操作，<strong>应用程序只是发起系统调用，实际的IO操作还是由操作系统的内核来完成</strong></p>
<p>常见的IO操作</p>
<ul>
<li>磁盘IO（读写文件）</li>
<li>网络IO（网络请求和响应）</li>
</ul>
<h3 id="同步与异步"><a href="#同步与异步" class="headerlink" title="同步与异步"></a>同步与异步</h3><blockquote>
<p>同步</p>
</blockquote>
<p>就是发起一个调用后，<strong>被调用者</strong>处理完请求前，调用不返回。</p>
<blockquote>
<p>异步</p>
</blockquote>
<p>就是发起一个调用后，立即得到<strong>被调用方</strong>的回响应表示已接受到请求，但此时被调用者还未返回结果，这个时候 我们可以处理其他请求，等 请求处理完成后，被调用者常常依靠事件，回调等方式通知调用者其返回结果。</p>
<p>同步和异步最大的区别就在于，被调用方的<strong>执行方式</strong>和<strong>返回时机</strong>，同步是指被调用方执行完成之后再返回，异步是指被调用方先返回再执行，做完之后再想办法通知调用方。</p>
<h3 id="阻塞与非阻塞"><a href="#阻塞与非阻塞" class="headerlink" title="阻塞与非阻塞"></a>阻塞与非阻塞</h3><blockquote>
<p>阻塞</p>
</blockquote>
<p>发起一个请求，<strong>调用者</strong>一直等待请求结果返回，也就是说当前线程被挂起，无法执行其他任务，直到条件就绪才继续</p>
<blockquote>
<p>非阻塞</p>
</blockquote>
<p>发起一个请求，<strong>调用者</strong>不用一直等待，可以先去干别事情</p>
<h3 id="同步，异步，阻塞，非阻塞的区别"><a href="#同步，异步，阻塞，非阻塞的区别" class="headerlink" title="同步，异步，阻塞，非阻塞的区别"></a>同步，异步，阻塞，非阻塞的区别</h3><p>同步与阻塞不是一回事，针对的对象不一样，</p>
<p>阻塞和非阻塞针对的时<strong>调用者</strong>，</p>
<p>同步和异步针对的时<strong>被调用者</strong></p>
<h3 id="常见的IO模型"><a href="#常见的IO模型" class="headerlink" title="常见的IO模型"></a>常见的IO模型</h3><h4 id="Java中的"><a href="#Java中的" class="headerlink" title="Java中的"></a>Java中的</h4><p><strong>BIO</strong>（BLockingIO）</p>
<p>属于同步阻塞IO，应用程序发起read请求后，会一致阻塞，直到 内核将数据拷贝到用户空间</p>
<p><img src="https://blog-picgo1-1312893782.cos.ap-shanghai.myqcloud.com//blog/202208082056243.png" alt="img"></p>
<p>在 用户IO操作交少时可以使用，一旦IO操作过大将堆系统的性能造成很大的影响。</p>
<p><strong>NIO</strong>（No-blockingIO）</p>
<p>非阻塞队列，再Java1.4中引入，对应java.nio包，支持面向缓冲 ，基于通道的IO操作，在高负载，高并发 的情况下一个使用NIO</p>
<ul>
<li>同步非阻塞队列：<br>  <img src="https://blog-picgo1-1312893782.cos.ap-shanghai.myqcloud.com//blog/202208082208284.png" alt="img"></li>
</ul>
<p>相对于同步阻塞队列而言，，同步阻塞队列可以一直向内核发送read请求直到内核把数据拷贝到用户空间</p>
<p>通过这种轮询操作避免了一直阻塞</p>
<p>但这样应用程序对IO系统调用轮询数据，判断其是否准备好对CPU的资源消耗较大</p>
<ul>
<li>IO多路复用</li>
</ul>
<p><img src="https://blog-picgo1-1312893782.cos.ap-shanghai.myqcloud.com//blog/202208082216512.jpg" alt="88ff862764024c3b8567367df11df6ab_tplv-k3u1fbpfcp-watermark (1)"></p>
<p>首先发起 select调用，询问内核该数据是否就绪，准备好了则调用其IO操作，IO操作的过程还是阻塞的</p>
<p>但减少了无效的系统调用，减少了对CPU的消耗</p>
<p>NIO选择器（Selector）也被称为多路复用器，通过它只需一个线程便可管理多个客户端连接，</p>
<p>当客户端数据到了之后才会为其服务</p>
<p><img src="https://blog-picgo1-1312893782.cos.ap-shanghai.myqcloud.com//blog/202208082221008.png" alt="img"></p>
<p><strong>AIO</strong></p>
<p>异步IO是通过事件或回调实现的，应用操作之后会直接返回，当后台处理完成，操作系统会通知相应的线程进行后续的操作</p>
<p><img src="https://blog-picgo1-1312893782.cos.ap-shanghai.myqcloud.com//blog/202208082225460.png" alt="img"></p>
<h4 id="Linux中的"><a href="#Linux中的" class="headerlink" title="Linux中的"></a>Linux中的</h4><blockquote>
<p>同步阻塞IO</p>
</blockquote>
<blockquote>
<p>同步非阻塞IO</p>
</blockquote>
<blockquote>
<p>多路复用IO</p>
</blockquote>
<blockquote>
<p>信号驱动IO</p>
</blockquote>
<blockquote>
<p>异步IO</p>
</blockquote>

    </div>
    
    
    
    
    
    
    
</div>

                <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2023 Hexo
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;John Doe
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

            </div>
            </transition>
            
            <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
            </transition>
            
        </div>
        <script src="/myblog.github.io/js/main.js"></script>
        
        




        
    </body>
</html>
